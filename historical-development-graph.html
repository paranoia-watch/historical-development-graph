<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../chart-elements/chart-line.html">
<script src="../moment/moment.js"></script>

<!--
`historical-development-graph`


@demo demo/index.html 
-->

<dom-module id="historical-development-graph">
  <template>
    <style>
      :host {
        display: block;
        --color-red: rgba(255, 0, 80, 1);
        background-color: black;
      }

      .container {
        
      }

      button {
        cursor: pointer;
      }

      header {
        position: relative;
        z-index: 1;
        background-color: black;
      }

      chart-line {
        width: 100%;
        min-height: 10vh;
        color: white;
        margin-top: -24px;
        z-index: 0;
      }

      #select-period {
        display: flex;
      }

      #select-period button {
        flex: 1;
        background-color: transparent;
        outline: none;
        border: 2px solid transparent;
        border-bottom-color: rgba(255, 255, 255, 0.2);
        height: 54px;
        color: white;
        font-size: 18px;
      }

      #select-location {
        display: flex;
        flex-direction: column;
        width: 100%;
        height: 54px;
        position: relative;
        padding: 20px 40px;

      }

      h1 {
        color: var(--color-red);
        font-size: 14px;
        font-weight: bolder;
        margin-top: 20px;
        text-transform: uppercase;
      }

      #selectedLocationButton {
        flex: 1;
        border: 0;
        background-color: transparent;
        color: var(--color-red);
/*        border-bottom: 2px solid var(--color-red);
*/        position: relative;
        outline: none;
        font-size: 18px;
        display: flex;
        justify-content: flex-start;
        align-items: center;
        padding: 0;
      }

      svg {
        width: 15px;
        height: 12px;
      }

      #selectedLocationButton svg {
        width: 15px;
        height: 12px;
        margin: 3px 0 0 5px;
      }

      svg g {
        fill: var(--color-red);        
      }

      svg g:hover, svg g:active {
        fill: white;        
      }

      #select-location select {
        position: absolute;
        width: 25%;
        height: 54px;
        opacity: 0;
        font-size: 18px;
      }

/*      #select-location::before {
        position: absolute;
        z-index: 2;
        content: attr(data-value);
        top:0;
        left:0;
        right: 0;
        bottom: 0;
        background-color: black;
        box-sizing: border-box;
        text-align: center;
        font-size: 18px;
        color: white;
      }*/

      #select-period button[selected] {
        border-bottom-color: var(--color-red);
      }

      footer {
        display: flex;
      }

      footer h5 {
        flex: 2;
        font-size: 18px;
        color: var(--color-red);
        text-align: center;
        font-weight: 400;
      }

      footer button {
        background-color: transparent;
        border: 0;
        width: 100px;
        outline: none;
        cursor: pointer;
      }

      footer #prevButton svg {
        transform: rotate(90deg);
      }

      footer #nextButton svg {
        transform: rotate(-90deg);
      }
    </style>

    <div class="container">

    <header>

      <nav id="select-period">
        <button value="week" on-tap="_selectPeriod" selected$="[[_selectedPeriodIsWeek]]">Week</button>
        <button value="month" on-tap="_selectPeriod" selected$="[[_selectedPeriodIsMonth]]">Month</button>
        <button value="year" on-tap="_selectPeriod" selected$="[[_selectedPeriodIsYear]]">Year</button>
      </nav>

      <nav id="select-location">
        <button id="selectedLocationButton">
          [[selectedLocation]]
          <svg viewBox="0 0 15 12" version="1.1" xmlns="http://www.w3.org/2000/svg">
              <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                <polygon transform="translate(7.700000, 6.000000) rotate(-90.000000) translate(-7.700000, -6.000000) " points="11.4 1.4 10 -1.70530257e-13 4 6 10 12 11.4 10.6 6.8 6"></polygon>
              </g>
          </svg>
          </button>
        <select value="{{selectedLocation::change}}">
          <option value="Amsterdam">Amsterdam</option>
          <option value="Berlin">Berlin</option>
          <option value="Paris">Paris</option>
        </select>
        <h1>Historical development</h1>
      </nav>

    </header>

    <chart-line data="[[data]]"></chart-line>

    <footer>
      <button id="prevButton" on-tap="_selectPreviousPeriod">
      <svg viewBox="0 0 15 12" version="1.1" xmlns="http://www.w3.org/2000/svg">
          <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
            <polygon transform="translate(7.700000, 6.000000) rotate(-90.000000) translate(-7.700000, -6.000000) " points="11.4 1.4 10 -1.70530257e-13 4 6 10 12 11.4 10.6 6.8 6"></polygon>
          </g>
      </svg>
      </button>
      <h5>[[selectedPeriodLabel]]</h5>

      <button id="nextButton" on-tap="_selectNextPeriod">
      <svg viewBox="0 0 15 12" version="1.1" xmlns="http://www.w3.org/2000/svg">
          <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
            <polygon transform="translate(7.700000, 6.000000) rotate(-90.000000) translate(-7.700000, -6.000000) " points="11.4 1.4 10 -1.70530257e-13 4 6 10 12 11.4 10.6 6.8 6"></polygon>
          </g>
      </svg>
      </button>
    </footer>

    </div>

  </template>

  <script>
    Polymer({

      is: 'historical-development-graph',

      properties: {

        socketData: {
          type: Object,
          value: {"Amsterdam": [{"date": "20160612","week": 24,"month": 6,"year": 2016,"averageWeight": 5.212896172564732},{"date": "20160613","week": 24,"month": 6,"year": 2016,"averageWeight": 5.8941084766519225},{"date": "20160614","week": 24,"month": 6,"year": 2016,"averageWeight": 5.718266504906595},{"date": "20160615","week": 24,"month": 6,"year": 2016,"averageWeight": 7.157513847519428},{"date": "20160616","week": 24,"month": 6,"year": 2016,"averageWeight": 6.675727143160811},{"date": "20160617","week": 24,"month": 6,"year": 2016,"averageWeight": 6.428106623106604},{"date": "20160618","week": 24,"month": 6,"year": 2016,"averageWeight": 7.323555233884524},{"date": "20160619","week": 25,"month": 6,"year": 2016,"averageWeight": 6.98661587379235},{"date": "20160620","week": 25,"month": 6,"year": 2016,"averageWeight": 7.58459010742803},{"date": "20160621","week": 25,"month": 6,"year": 2016,"averageWeight": 10.477187508173563},{"date": "20160622","week": 25,"month": 6,"year": 2016,"averageWeight": 5.411944140688025},{"date": "20160623","week": 25,"month": 6,"year": 2016,"averageWeight": 7.502838719105637},{"date": "20160624","week": 25,"month": 6,"year": 2016,"averageWeight": 6.617405180648431},{"date": "20160911","week": 37,"month": 9,"year": 2016,"averageWeight": 7.658958999709226},{"date": "20160912","week": 37,"month": 9,"year": 2016,"averageWeight": 6.227425649024407},{"date": "20160913","week": 37,"month": 9,"year": 2016,"averageWeight": 6.3663680881453155},{"date": "20160914","week": 37,"month": 9,"year": 2016,"averageWeight": 7.487787190782797},{"date": "20160915","week": 37,"month": 9,"year": 2016,"averageWeight": 6.533139546565766},{"date": "20160916","week": 37,"month": 9,"year": 2016,"averageWeight": 9.972214914856133},{"date": "20160924","week": 38,"month": 9,"year": 2016,"averageWeight": 6.989093962805749},{"date": "20160925","week": 39,"month": 9,"year": 2016,"averageWeight": 5.004112013484512},{"date": "20160926","week": 39,"month": 9,"year": 2016,"averageWeight": 8.713079122592996},{"date": "20160927","week": 39,"month": 9,"year": 2016,"averageWeight": 7.0733591992802545},{"date": "20160928","week": 39,"month": 9,"year": 2016,"averageWeight": 7.94050026630144},{"date": "20160929","week": 39,"month": 9,"year": 2016,"averageWeight": 6.48474254542773},{"date": "20160930","week": 39,"month": 9,"year": 2016,"averageWeight": 8.662651555086972},{"date": "20161001","week": 39,"month": 10,"year": 2016,"averageWeight": 7.09154796408037},{"date": "20161002","week": 40,"month": 10,"year": 2016,"averageWeight": 8.305179538512874},{"date": "20161003","week": 40,"month": 10,"year": 2016,"averageWeight": 6.23675459687603},{"date": "20161004","week": 40,"month": 10,"year": 2016,"averageWeight": 7.21246095696957},{"date": "20161005","week": 40,"month": 10,"year": 2016,"averageWeight": 3.7777775882653932},{"date": "20161022","week": 42,"month": 10,"year": 2016,"averageWeight": 15.546751873767256},{"date": "20161023","week": 43,"month": 10,"year": 2016,"averageWeight": 13.183117349331388},{"date": "20161024","week": 43,"month": 10,"year": 2016,"averageWeight": 14.214357411722553},{"date": "20161025","week": 43,"month": 10,"year": 2016,"averageWeight": 9.619638034610446},{"date": "20161026","week": 43,"month": 10,"year": 2016,"averageWeight": 6.237601108801116},{"date": "20161027","week": 43,"month": 10,"year": 2016,"averageWeight": 5.950436561637555},{"date": "20161028","week": 43,"month": 10,"year": 2016,"averageWeight": 5.748930957102597},{"date": "20161029","week": 43,"month": 10,"year": 2016,"averageWeight": 7.205128629016872},{"date": "20161030","week": 44,"month": 10,"year": 2016,"averageWeight": 5.712984801020951},{"date": "20161031","week": 44,"month": 10,"year": 2016,"averageWeight": 5.643907850653189},{"date": "20161101","week": 44,"month": 11,"year": 2016,"averageWeight": 5.839235069354832},{"date": "20161102","week": 44,"month": 11,"year": 2016,"averageWeight": 8.87062791126086},{"date": "20161103","week": 44,"month": 11,"year": 2016,"averageWeight": 11.259781603351017},{"date": "20161104","week": 44,"month": 11,"year": 2016,"averageWeight": 11.645099462755946},{"date": "20161105","week": 44,"month": 11,"year": 2016,"averageWeight": 7.582092027152295},{"date": "20161106","week": 45,"month": 11,"year": 2016,"averageWeight": 8.981713607728954},{"date": "20161107","week": 45,"month": 11,"year": 2016,"averageWeight": 7.574844053005836},{"date": "20161108","week": 45,"month": 11,"year": 2016,"averageWeight": 9.695505014465981},{"date": "20161109","week": 45,"month": 11,"year": 2016,"averageWeight": 5.106680706980217},{"date": "20161110","week": 45,"month": 11,"year": 2016,"averageWeight": 13.136425455647737},{"date": "20161111","week": 45,"month": 11,"year": 2016,"averageWeight": 9.722035141639344},{"date": "20161112","week": 45,"month": 11,"year": 2016,"averageWeight": 10.477161731599606},{"date": "20161113","week": 46,"month": 11,"year": 2016,"averageWeight": 5.210760831763976},{"date": "20161114","week": 46,"month": 11,"year": 2016,"averageWeight": 6.40282644963478},{"date": "20161115","week": 46,"month": 11,"year": 2016,"averageWeight": 6.66753333665043},{"date": "20161116","week": 46,"month": 11,"year": 2016,"averageWeight": 8.97157588961508},{"date": "20161117","week": 46,"month": 11,"year": 2016,"averageWeight": 12.897840631023566},{"date": "20161118","week": 46,"month": 11,"year": 2016,"averageWeight": 11.20345136799886},{"date": "20161119","week": 46,"month": 11,"year": 2016,"averageWeight": 10.159603108824465},{"date": "20161120","week": 47,"month": 11,"year": 2016,"averageWeight": 8.910991984249769},{"date": "20161121","week": 47,"month": 11,"year": 2016,"averageWeight": 9.723823004973854},{"date": "20161122","week": 47,"month": 11,"year": 2016,"averageWeight": 8.341692546121},{"date": "20161123","week": 47,"month": 11,"year": 2016,"averageWeight": 8.932701885828621},{"date": "20161124","week": 47,"month": 11,"year": 2016,"averageWeight": 9.160799093158428},{"date": "20161125","week": 47,"month": 11,"year": 2016,"averageWeight": 7.839401940134662},{"date": "20161126","week": 47,"month": 11,"year": 2016,"averageWeight": 6.486189810189823},{"date": "20161127","week": 48,"month": 11,"year": 2016,"averageWeight": 5.777257256018329},{"date": "20161128","week": 48,"month": 11,"year": 2016,"averageWeight": 5.569564140948871},{"date": "20161129","week": 48,"month": 11,"year": 2016,"averageWeight": 7.325632959755483},{"date": "20161130","week": 48,"month": 11,"year": 2016,"averageWeight": 7.258559140837939},{"date": "20161201","week": 48,"month": 12,"year": 2016,"averageWeight": 6.073049019413835},{"date": "20161202","week": 48,"month": 12,"year": 2016,"averageWeight": 7.771653208669767},{"date": "20161203","week": 48,"month": 12,"year": 2016,"averageWeight": 6.603032167832158},{"date": "20161204","week": 49,"month": 12,"year": 2016,"averageWeight": 4.751953277092796},{"date": "20161205","week": 49,"month": 12,"year": 2016,"averageWeight": 7.469212919060603},{"date": "20161206","week": 49,"month": 12,"year": 2016,"averageWeight": 8.581567521849427},{"date": "20161207","week": 49,"month": 12,"year": 2016,"averageWeight": 6.135287769320874},{"date": "20161208","week": 49,"month": 12,"year": 2016,"averageWeight": 7.544469890413893},{"date": "20161209","week": 49,"month": 12,"year": 2016,"averageWeight": 9.592542554080072},{"date": "20161210","week": 49,"month": 12,"year": 2016,"averageWeight": 11.463310424246872},{"date": "20161211","week": 50,"month": 12,"year": 2016,"averageWeight": 15.469524553658639}],"Paris": [{"date": "20160612","week": 24,"month": 6,"year": 2016,"averageWeight": 15.340080112751249},{"date": "20160613","week": 24,"month": 6,"year": 2016,"averageWeight": 25.855476647232287},{"date": "20160614","week": 24,"month": 6,"year": 2016,"averageWeight": 26.264844525726346},{"date": "20160615","week": 24,"month": 6,"year": 2016,"averageWeight": 24.811172483361894},{"date": "20160616","week": 24,"month": 6,"year": 2016,"averageWeight": 22.05534331681386},{"date": "20160617","week": 24,"month": 6,"year": 2016,"averageWeight": 37.747173008594324},{"date": "20160618","week": 24,"month": 6,"year": 2016,"averageWeight": 22.8861142285134},{"date": "20160619","week": 25,"month": 6,"year": 2016,"averageWeight": 10.783542161144034},{"date": "20160620","week": 25,"month": 6,"year": 2016,"averageWeight": 29.943373585369795},{"date": "20160621","week": 25,"month": 6,"year": 2016,"averageWeight": 31.126455946879897},{"date": "20160622","week": 25,"month": 6,"year": 2016,"averageWeight": 19.184408149479587},{"date": "20160623","week": 25,"month": 6,"year": 2016,"averageWeight": 20.85063483589437},{"date": "20160624","week": 25,"month": 6,"year": 2016,"averageWeight": 16.20998140736768},{"date": "20160911","week": 37,"month": 9,"year": 2016,"averageWeight": 18.83659874868898},{"date": "20160912","week": 37,"month": 9,"year": 2016,"averageWeight": 44.70032722307292},{"date": "20160913","week": 37,"month": 9,"year": 2016,"averageWeight": 40.90799364382116},{"date": "20160914","week": 37,"month": 9,"year": 2016,"averageWeight": 37.99113837442501},{"date": "20160915","week": 37,"month": 9,"year": 2016,"averageWeight": 25.308005566293055},{"date": "20160916","week": 37,"month": 9,"year": 2016,"averageWeight": 62.910509039962584},{"date": "20160924","week": 38,"month": 9,"year": 2016,"averageWeight": 19.536561972152505},{"date": "20160925","week": 39,"month": 9,"year": 2016,"averageWeight": 15.825123245234245},{"date": "20160926","week": 39,"month": 9,"year": 2016,"averageWeight": 21.088776770187742},{"date": "20160927","week": 39,"month": 9,"year": 2016,"averageWeight": 41.931620866909135},{"date": "20160928","week": 39,"month": 9,"year": 2016,"averageWeight": 21.741510396394638},{"date": "20160929","week": 39,"month": 9,"year": 2016,"averageWeight": 33.91767621422001},{"date": "20160930","week": 39,"month": 9,"year": 2016,"averageWeight": 34.50885332192139},{"date": "20161001","week": 39,"month": 10,"year": 2016,"averageWeight": 22.54768197030594},{"date": "20161002","week": 40,"month": 10,"year": 2016,"averageWeight": 17.394919803600644},{"date": "20161003","week": 40,"month": 10,"year": 2016,"averageWeight": 24.716948352485325},{"date": "20161004","week": 40,"month": 10,"year": 2016,"averageWeight": 24.5432177612597},{"date": "20161005","week": 40,"month": 10,"year": 2016,"averageWeight": 54.951100899100844},{"date": "20161022","week": 42,"month": 10,"year": 2016,"averageWeight": 10.270289837348644},{"date": "20161023","week": 43,"month": 10,"year": 2016,"averageWeight": 9.686800679201275},{"date": "20161024","week": 43,"month": 10,"year": 2016,"averageWeight": 22.12297217601032},{"date": "20161025","week": 43,"month": 10,"year": 2016,"averageWeight": 50.14895711054279},{"date": "20161026","week": 43,"month": 10,"year": 2016,"averageWeight": 25.535429992297768},{"date": "20161027","week": 43,"month": 10,"year": 2016,"averageWeight": 21.78430932066087},{"date": "20161028","week": 43,"month": 10,"year": 2016,"averageWeight": 19.228955661414354},{"date": "20161029","week": 43,"month": 10,"year": 2016,"averageWeight": 20.1873333128163},{"date": "20161030","week": 44,"month": 10,"year": 2016,"averageWeight": 17.471616741270406},{"date": "20161031","week": 44,"month": 10,"year": 2016,"averageWeight": 13.84228242110456},{"date": "20161101","week": 44,"month": 11,"year": 2016,"averageWeight": 18.01691155155827},{"date": "20161102","week": 44,"month": 11,"year": 2016,"averageWeight": 24.009345801153998},{"date": "20161103","week": 44,"month": 11,"year": 2016,"averageWeight": 31.19290609199396},{"date": "20161104","week": 44,"month": 11,"year": 2016,"averageWeight": 31.640431174481048},{"date": "20161105","week": 44,"month": 11,"year": 2016,"averageWeight": 19.480817153599805},{"date": "20161106","week": 45,"month": 11,"year": 2016,"averageWeight": 24.044970368384853},{"date": "20161107","week": 45,"month": 11,"year": 2016,"averageWeight": 43.92340086761034},{"date": "20161108","week": 45,"month": 11,"year": 2016,"averageWeight": 40.28793590410922},{"date": "20161109","week": 45,"month": 11,"year": 2016,"averageWeight": 20.628943059968485},{"date": "20161110","week": 45,"month": 11,"year": 2016,"averageWeight": 47.996423426120195},{"date": "20161111","week": 45,"month": 11,"year": 2016,"averageWeight": 35.281588905269935},{"date": "20161112","week": 45,"month": 11,"year": 2016,"averageWeight": 38.93428813538646},{"date": "20161113","week": 46,"month": 11,"year": 2016,"averageWeight": 18.840777897883818},{"date": "20161114","week": 46,"month": 11,"year": 2016,"averageWeight": 19.32048235090751},{"date": "20161115","week": 46,"month": 11,"year": 2016,"averageWeight": 31.189635397000472},{"date": "20161116","week": 46,"month": 11,"year": 2016,"averageWeight": 26.414975613379113},{"date": "20161117","week": 46,"month": 11,"year": 2016,"averageWeight": 22.210321164371337},{"date": "20161118","week": 46,"month": 11,"year": 2016,"averageWeight": 34.880707295052545},{"date": "20161119","week": 46,"month": 11,"year": 2016,"averageWeight": 14.541908804801345},{"date": "20161120","week": 47,"month": 11,"year": 2016,"averageWeight": 8.9505707933104},{"date": "20161121","week": 47,"month": 11,"year": 2016,"averageWeight": 31.850440788858876},{"date": "20161122","week": 47,"month": 11,"year": 2016,"averageWeight": 28.777235969904247},{"date": "20161123","week": 47,"month": 11,"year": 2016,"averageWeight": 27.83297809082499},{"date": "20161124","week": 47,"month": 11,"year": 2016,"averageWeight": 19.199352858151073},{"date": "20161125","week": 47,"month": 11,"year": 2016,"averageWeight": 30.487040008046836},{"date": "20161126","week": 47,"month": 11,"year": 2016,"averageWeight": 19.16875770529752},{"date": "20161127","week": 48,"month": 11,"year": 2016,"averageWeight": 17.435536088231277},{"date": "20161128","week": 48,"month": 11,"year": 2016,"averageWeight": 14.23233142218516},{"date": "20161129","week": 48,"month": 11,"year": 2016,"averageWeight": 20.184651752045763},{"date": "20161130","week": 48,"month": 11,"year": 2016,"averageWeight": 22.88276958112741},{"date": "20161201","week": 48,"month": 12,"year": 2016,"averageWeight": 20.846810008293225},{"date": "20161202","week": 48,"month": 12,"year": 2016,"averageWeight": 25.64358150579713},{"date": "20161203","week": 48,"month": 12,"year": 2016,"averageWeight": 23.569200059920643},{"date": "20161204","week": 49,"month": 12,"year": 2016,"averageWeight": 12.056837787813725},{"date": "20161205","week": 49,"month": 12,"year": 2016,"averageWeight": 29.96561608435686},{"date": "20161206","week": 49,"month": 12,"year": 2016,"averageWeight": 37.84534735233478},{"date": "20161207","week": 49,"month": 12,"year": 2016,"averageWeight": 13.116056361398648},{"date": "20161208","week": 49,"month": 12,"year": 2016,"averageWeight": 27.921842907910825},{"date": "20161209","week": 49,"month": 12,"year": 2016,"averageWeight": 31.328565037515155},{"date": "20161210","week": 49,"month": 12,"year": 2016,"averageWeight": 19.226060259917276},{"date": "20161211","week": 50,"month": 12,"year": 2016,"averageWeight": 20.72757336899145}],"Berlin": [{"date": "20160612","week": 24,"month": 6,"year": 2016,"averageWeight": 21.475058012187922},{"date": "20160613","week": 24,"month": 6,"year": 2016,"averageWeight": 22.27575815988955},{"date": "20160614","week": 24,"month": 6,"year": 2016,"averageWeight": 21.213048482042417},{"date": "20160615","week": 24,"month": 6,"year": 2016,"averageWeight": 28.437960758558326},{"date": "20160616","week": 24,"month": 6,"year": 2016,"averageWeight": 21.161436772183013},{"date": "20160617","week": 24,"month": 6,"year": 2016,"averageWeight": 18.738488481745925},{"date": "20160618","week": 24,"month": 6,"year": 2016,"averageWeight": 34.61244672093671},{"date": "20160619","week": 25,"month": 6,"year": 2016,"averageWeight": 19.47212003186686},{"date": "20160620","week": 25,"month": 6,"year": 2016,"averageWeight": 31.609290577082117},{"date": "20160621","week": 25,"month": 6,"year": 2016,"averageWeight": 14.057225806451635},{"date": "20160622","week": 25,"month": 6,"year": 2016,"averageWeight": 14.965584562996602},{"date": "20160623","week": 25,"month": 6,"year": 2016,"averageWeight": 13.878374545671178},{"date": "20160624","week": 25,"month": 6,"year": 2016,"averageWeight": 7.383169811320753},{"date": "20160911","week": 37,"month": 9,"year": 2016,"averageWeight": 18.415700586409145},{"date": "20160912","week": 37,"month": 9,"year": 2016,"averageWeight": 33.674685854165126},{"date": "20160913","week": 37,"month": 9,"year": 2016,"averageWeight": 39.36124144672553},{"date": "20160914","week": 37,"month": 9,"year": 2016,"averageWeight": 17.912062301898423},{"date": "20160915","week": 37,"month": 9,"year": 2016,"averageWeight": 14.18393011405001},{"date": "20160916","week": 37,"month": 9,"year": 2016,"averageWeight": 7.625604947816013},{"date": "20160924","week": 38,"month": 9,"year": 2016,"averageWeight": 8.170990151716815},{"date": "20160925","week": 39,"month": 9,"year": 2016,"averageWeight": 14.649704907161796},{"date": "20160926","week": 39,"month": 9,"year": 2016,"averageWeight": 12.789650505396589},{"date": "20160927","week": 39,"month": 9,"year": 2016,"averageWeight": 12.819705538561022},{"date": "20160928","week": 39,"month": 9,"year": 2016,"averageWeight": 14.204805674722845},{"date": "20160929","week": 39,"month": 9,"year": 2016,"averageWeight": 12.88152988275665},{"date": "20160930","week": 39,"month": 9,"year": 2016,"averageWeight": 9.557809347001387},{"date": "20161001","week": 39,"month": 10,"year": 2016,"averageWeight": 21.283445237465845},{"date": "20161002","week": 40,"month": 10,"year": 2016,"averageWeight": 17.32202345458162},{"date": "20161003","week": 40,"month": 10,"year": 2016,"averageWeight": 11.146630634108673},{"date": "20161004","week": 40,"month": 10,"year": 2016,"averageWeight": 27.251591902834043},{"date": "20161005","week": 40,"month": 10,"year": 2016,"averageWeight": 11.32440353089534},{"date": "20161022","week": 42,"month": 10,"year": 2016,"averageWeight": 13.63643874643876},{"date": "20161023","week": 43,"month": 10,"year": 2016,"averageWeight": 10.267026079333778},{"date": "20161024","week": 43,"month": 10,"year": 2016,"averageWeight": 15.887327440285873},{"date": "20161025","week": 43,"month": 10,"year": 2016,"averageWeight": 38.4198284061378},{"date": "20161026","week": 43,"month": 10,"year": 2016,"averageWeight": 19.171318068776266},{"date": "20161027","week": 43,"month": 10,"year": 2016,"averageWeight": 10.6653478990073},{"date": "20161028","week": 43,"month": 10,"year": 2016,"averageWeight": 18.401785232311568},{"date": "20161029","week": 43,"month": 10,"year": 2016,"averageWeight": 17.77372771862663},{"date": "20161030","week": 44,"month": 10,"year": 2016,"averageWeight": 18.501274851857975},{"date": "20161031","week": 44,"month": 10,"year": 2016,"averageWeight": 21.208215271907463},{"date": "20161101","week": 44,"month": 11,"year": 2016,"averageWeight": 15.04063527851459},{"date": "20161102","week": 44,"month": 11,"year": 2016,"averageWeight": 27.918223794085826},{"date": "20161103","week": 44,"month": 11,"year": 2016,"averageWeight": 32.20898930240299},{"date": "20161104","week": 44,"month": 11,"year": 2016,"averageWeight": 38.13519885847724},{"date": "20161105","week": 44,"month": 11,"year": 2016,"averageWeight": 23.248020094773313},{"date": "20161106","week": 45,"month": 11,"year": 2016,"averageWeight": 17.768571428571473},{"date": "20161107","week": 45,"month": 11,"year": 2016,"averageWeight": 25.098678921836697},{"date": "20161108","week": 45,"month": 11,"year": 2016,"averageWeight": 27.7533754630639},{"date": "20161109","week": 45,"month": 11,"year": 2016,"averageWeight": 5.849829426653458},{"date": "20161110","week": 45,"month": 11,"year": 2016,"averageWeight": 25.71375408223478},{"date": "20161111","week": 45,"month": 11,"year": 2016,"averageWeight": 38.30969816849845},{"date": "20161112","week": 45,"month": 11,"year": 2016,"averageWeight": 40.57692499400907},{"date": "20161113","week": 46,"month": 11,"year": 2016,"averageWeight": 14.041566433566372},{"date": "20161114","week": 46,"month": 11,"year": 2016,"averageWeight": 22.003663758921455},{"date": "20161115","week": 46,"month": 11,"year": 2016,"averageWeight": 19.01365458865456},{"date": "20161116","week": 46,"month": 11,"year": 2016,"averageWeight": 27.86304036361835},{"date": "20161117","week": 46,"month": 11,"year": 2016,"averageWeight": 30.35907275568675},{"date": "20161118","week": 46,"month": 11,"year": 2016,"averageWeight": 21.902130177514756},{"date": "20161119","week": 46,"month": 11,"year": 2016,"averageWeight": 19.252622643718514},{"date": "20161120","week": 47,"month": 11,"year": 2016,"averageWeight": 24.71435555880842},{"date": "20161121","week": 47,"month": 11,"year": 2016,"averageWeight": 32.12514259891545},{"date": "20161122","week": 47,"month": 11,"year": 2016,"averageWeight": 18.31267737117248},{"date": "20161123","week": 47,"month": 11,"year": 2016,"averageWeight": 11.328925546930156},{"date": "20161124","week": 47,"month": 11,"year": 2016,"averageWeight": 32.82767603997202},{"date": "20161125","week": 47,"month": 11,"year": 2016,"averageWeight": 16.581981173701987},{"date": "20161126","week": 47,"month": 11,"year": 2016,"averageWeight": 11.719928578322556},{"date": "20161127","week": 48,"month": 11,"year": 2016,"averageWeight": 14.541979725700655},{"date": "20161128","week": 48,"month": 11,"year": 2016,"averageWeight": 20.394217890706578},{"date": "20161129","week": 48,"month": 11,"year": 2016,"averageWeight": 15.28689923832779},{"date": "20161130","week": 48,"month": 11,"year": 2016,"averageWeight": 21.3272026514139},{"date": "20161201","week": 48,"month": 12,"year": 2016,"averageWeight": 9.05064146320117},{"date": "20161202","week": 48,"month": 12,"year": 2016,"averageWeight": 20.746670091177627},{"date": "20161203","week": 48,"month": 12,"year": 2016,"averageWeight": 14.797916054221787},{"date": "20161204","week": 49,"month": 12,"year": 2016,"averageWeight": 14.526965174129323},{"date": "20161205","week": 49,"month": 12,"year": 2016,"averageWeight": 25.497299088649523},{"date": "20161206","week": 49,"month": 12,"year": 2016,"averageWeight": 29.261024369779978},{"date": "20161207","week": 49,"month": 12,"year": 2016,"averageWeight": 21.316916823014303},{"date": "20161208","week": 49,"month": 12,"year": 2016,"averageWeight": 14.390975041218933},{"date": "20161209","week": 49,"month": 12,"year": 2016,"averageWeight": 29.594982305830015},{"date": "20161210","week": 49,"month": 12,"year": 2016,"averageWeight": 35.312428205128256},{"date": "20161211","week": 50,"month": 12,"year": 2016,"averageWeight": 27.380040287045237}]}
        },

        data: {
          type: Object,
          computed: '_computeData(socketData.*, selectedLocation, selectedPeriod, selectedYear, selectedMonth, selectedWeek)'
        },

        selectedLocation: {
          type: String,
          value: 'Amsterdam'
        },

        _selectedLocationIsAmsterdam: {
          type: Boolean,
          computed: '_computeSelectedLocationIsAmsterdam(selectedLocation)'
        },

        _selectedLocationIsBerlin: {
          type: Boolean,
          computed: '_computeSelectedLocationIsBerlin(selectedLocation)'
        },

        _selectedLocationIsParis: {
          type: Boolean,
          computed: '_computeSelectedLocationIsParis(selectedLocation)'
        },

        selectedPeriod: {
          type: String,
          value: 'year'
        },

        _selectedPeriodIsWeek: {
          type: Boolean,
          computed: '_computeSelectedPeriodIsWeek(selectedPeriod)'
        },

        _selectedPeriodIsMonth: {
          type: Boolean,
          computed: '_computeSelectedPeriodIsMonth(selectedPeriod)'
        },

        _selectedPeriodIsYear: {
          type: Boolean,
          computed: '_computeSelectedPeriodIsYear(selectedPeriod)'
        },

        availableYears: {
          type: Array,
          computed: '_computeAvailableYears(socketData.*, selectedLocation)'
        },

        selectedYear: {
          type: String,
          value: '2016'
        },

        availableMonths: {
          type: Array,
          computed: '_computeAvailableMonths(socketData.*, selectedLocation)'
        },

        selectedMonth: {
          type: String,
          value: '11'
        },

        availableWeeks: {
          type: Array,
          computed: '_computeAvailableWeeks(socketData.*, selectedLocation)'
        },

        availablePeriods: {
          type: Array,
          computed: '_computeAvailablePeriods(selectedPeriod, availableYears, availableMonths, availableWeeks)'
        },

        selectedWeek: {
          type: String,
          value: '46'
        },

        selectedPeriodLabel: {
          type: String,
          computed: '_computeSelectedPeriodLabel(selectedPeriod, selectedYear, selectedMonth, selectedWeek)'
        }

      },

      _selectPreviousPeriod: function() {
        switch(this.selectedPeriod) {
          case 'week':
            var selectedValue = parseInt(this.selectedWeek);
            break;
          case 'month':
            var selectedValue = parseInt(this.selectedMonth);
            break;
          case 'year':
            var selectedValue = parseInt(this.selectedYear);
            break;
        }
        var availablePeriods = this.availablePeriods;
        var selectedIndex = availablePeriods.indexOf(selectedValue);
        var newValue = (selectedIndex > 0) ? availablePeriods[selectedIndex-1] : availablePeriods[availablePeriods.length-1];

        switch(this.selectedPeriod) {
          case 'week':
            this.selectedWeek = newValue;
            break;
          case 'month':
            this.selectedMonth = newValue;
            break;
          case 'year':
            this.selectedYear = newValue;
            break;
        }
      },


      _selectNextPeriod: function() {
        switch(this.selectedPeriod) {
          case 'week':
            var selectedValue = parseInt(this.selectedWeek);
            break;
          case 'month':
            var selectedValue = parseInt(this.selectedMonth);
            break;
          case 'year':
            var selectedValue = parseInt(this.selectedYear);
            break;
        }
        var availablePeriods = this.availablePeriods;
        var selectedIndex = availablePeriods.indexOf(selectedValue);

        var newValue = (selectedIndex < (availablePeriods.length-1)) ? availablePeriods[selectedIndex+1] : availablePeriods[0];

        switch(this.selectedPeriod) {
          case 'week':
            this.selectedWeek = newValue;
            break;
          case 'month':
            this.selectedMonth = newValue;
            break;
          case 'year':
            this.selectedYear = newValue;
            break;
        }

      },

      _computeAvailablePeriods: function(selectedPeriod, availableYears, availableMonths, availableWeeks) {
        switch(selectedPeriod) {
          case 'week':
            var availablePeriods = availableWeeks;
            break;
          case 'month':
            var availablePeriods = availableMonths;
            break;
          case 'year':
            var availablePeriods = availableYears;
            break;
        }
        return availablePeriods;
      },

      _computeSelectedPeriodLabel: function(selectedPeriod, selectedYear, selectedMonth, selectedWeek) {
        switch(selectedPeriod) {
          case 'week':
            return 'Week ' + selectedWeek + ' ' + selectedYear;
            break;
          case 'month':
            switch(parseInt(selectedMonth)) {
              case 1:
              var label = 'January';
              break;
              case 2:
              var label = 'February';
              break;
              case 3:
              var label = 'March';
              break;
              case 4:
              var label = 'April';
              break;
              case 5:
              var label = 'May';
              break;
              case 6:
              var label = 'June';
              break;
              case 7:
              var label = 'July';
              break;
              case 8:
              var label = 'August';
              break;
              case 9:
              var label = 'September';
              break;
              case 10:
              var label = 'October';
              break;
              case 11:
              var label = 'November';
              break;
              case 12:
              var label = 'December';
              break;
            }
            return label + ' ' + selectedYear;
            break;
          case 'year':
            return selectedYear;
            break;
        }
      },

      _computeSelectedLocationIsAmsterdam: function(selectedLocation) {
        return selectedLocation == 'Amsterdam';
      },

      _computeSelectedLocationIsBerlin: function(selectedLocation) {
        return selectedLocation == 'Berlin';
      },

      _computeSelectedLocationIsParis: function(selectedLocation) {
        return selectedLocation == 'Paris';
      },

      _selectLocation: function(evt) {
        this.selectedLocation = evt.target.value;
      },

      _computeSelectedPeriodIsWeek: function(selectedPeriod) {
        return selectedPeriod == 'week';
      },

      _computeSelectedPeriodIsMonth: function(selectedPeriod) {
        return selectedPeriod == 'month';
      },

      _computeSelectedPeriodIsYear: function(selectedPeriod) {
        return selectedPeriod == 'year';
      },

      _selectPeriod: function(evt) {
        this.selectedPeriod = evt.target.value;
      },

      _computeAvailableYears: function(socketDataChange, selectedLocation) {
        var socketData = socketDataChange.base[selectedLocation];
        var years = [];
        socketData.map(function(locationValue) {
          if(years.indexOf(locationValue.year) === -1) years.push(locationValue.year);
        })          
        return years;
      },

      _computeAvailableMonths: function(socketDataChange, selectedLocation) {
        var socketData = socketDataChange.base[selectedLocation];
        var months = [];
        socketData.map(function(locationValue) {
          if(months.indexOf(locationValue.month) === -1) months.push(locationValue.month);
        })          
        return months;
      },

      _computeAvailableWeeks: function(socketDataChange, selectedLocation) {
        var socketData = socketDataChange.base[selectedLocation];
        var weeks = [];
        socketData.map(function(locationValue) {
          if(weeks.indexOf(locationValue.week) === -1) weeks.push(locationValue.week);
        })          
        return weeks;
      },

      _computeData: function(socketDataChange, selectedLocation, selectedPeriod, selectedYear, selectedMonth, selectedWeek) {
        var socketData = socketDataChange.base[selectedLocation];

        switch(selectedPeriod) {
          case 'week':
            var selectedValue = selectedWeek;
            break;
          case 'month':
            var selectedValue = selectedMonth;
            break;
          case 'year':
            var selectedValue = selectedYear;
            break;
        }

        var filteredLabelValues = socketData.filter(function(locationValue) {
          return locationValue[selectedPeriod] == selectedValue;
        })

        var labels = filteredLabelValues.map(function(value) {
          var labelDate = moment(value.date, 'YYYYMMDD');
          switch(selectedPeriod) {
            case 'week':
              return labelDate.format('dddd');
              break;
            case 'month':
              return labelDate.format('D');
              break;
            case 'year':
              return labelDate.format('D MMM');
              break;
          }
        })

        var filteredValues = socketData.filter(function(locationValue) {
        return locationValue[selectedPeriod] == selectedValue;
        })

        var locationValues = filteredValues.map(function(locationValue) {
          return locationValue.averageWeight;
        })

        var datasets = [{
          label: selectedLocation,
          data: locationValues,
          borderWidth: 2,
          pointBorderColor: 'transparent',
          backgroundColor: 'rgba(255, 0, 80, 1)'
        }]

        return {
          labels: labels,
          datasets: datasets
        }

      }

    });
  </script>
</dom-module>
